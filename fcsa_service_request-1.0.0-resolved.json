{
  "openapi": "3.0.0",
  "info": {
    "title": "CCT Customer Service Requests",
    "description": "This section provides an overview of all aspects of the application programmers’ interface, including registration to use the interface, the various resources that constitute the interface and how these should be orchestrated into an application that will deliver consistent and reliable results.",
    "contact": {
      "email": "cct@cct.co.za"
    },
    "license": {
      "name": "Apache 2.0",
      "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
    },
    "version": "2.1"
  },
  "servers": [
    {
      "url": "https://qaeservices1.capetown.gov.za/coct/api/zcur-guest/login",
      "description": "FCSA Service Request API"
    }
  ],
  "security": [
    {},
    {
      "cookieAuth": []
    }
  ],
  "tags": [
    {
      "name": "service_request_group",
      "description": "This process shows the flow of actions in which the application takes for the creation of a service request. \n"
    }
  ],
  "paths": {
    "/coct/api/zcur-guest/login": {
      "get": {
        "tags": [
          "service_request_group"
        ],
        "description": "Ths services is used to authenticate and retrieve the MYSAPSSO2 cookie or authentication token. \n",
        "parameters": [
          {
            "name": "cookie",
            "in": "query",
            "required": true,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "headers": {
              "Set-Cookie": {
                "description": "Pass this cookie back in subsequent requests.\n",
                "style": "simple",
                "explode": false,
                "schema": {
                  "$ref": "#/components/schemas/Login_Schema"
                }
              }
            }
          }
        },
        "security": [
          {
            "cookieAuth": []
          }
        ]
      }
    },
    "/coct/api/zsreq/session": {
      "get": {
        "tags": [
          "service_request_group"
        ],
        "summary": "This operation retrieves a new session identifier for the X-Session header parameter.\n",
        "parameters": [
          {
            "name": "cookie",
            "in": "query",
            "description": "This is the value of the public key issued  by the city to registered consumers.\n",
            "required": true,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "X-Service",
            "in": "header",
            "description": "This is the value of the public key issued  by the city to registered consumers. This is a mandatory header parameters.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-Session",
            "in": "header",
            "description": "This is the session key obtained periodically from the City representing the log file entry of a user’s activities. This is a mandatory header parameters.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Session_Schema"
                }
              }
            }
          },
          "500": {
            "description": "Error in retrieving all type codes and descriptions. (Internal)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error_Schema"
                }
              }
            }
          }
        }
      }
    },
    "/coct/api/zsreq/config/subtypes": {
      "get": {
        "tags": [
          "service_request_group"
        ],
        "summary": "This service gets the full range of subtype codes and descriptions for all service groups.\n",
        "parameters": [
          {
            "name": "X-Session",
            "in": "header",
            "description": "This is the session key obtained periodically from the City representing the log file entry of a user’s activities.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-Service",
            "in": "header",
            "description": "This is the value of the public key issued  by the city to registered consumers.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Config_Type_Schema"
                }
              }
            }
          },
          "500": {
            "description": "Error in retrieving all type codes and descriptions. (Internal)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error_Schema"
                }
              }
            }
          }
        }
      }
    },
    "/coct/api/zsreq/sr/{reference_no}": {
      "get": {
        "tags": [
          "service_request_group"
        ],
        "summary": "This operation is used to retrieve the current state of a service request given the service request number.\n",
        "parameters": [
          {
            "name": "reference_no",
            "in": "path",
            "description": "The reference number of the service request.\n",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-Signature",
            "in": "header",
            "description": "The X-Signature is mandatory for all POST operations. We create the signature by using HMAC (keyed-hash message authentication code).\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-Session",
            "in": "header",
            "description": "This is the session key obtained periodically from the City representing the log file entry of a user’s activities.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-Service",
            "in": "header",
            "description": "This is the value of the public key issued  by the city to registered consumers.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Request_Attributes_Detail_Schema"
                }
              }
            }
          },
          "500": {
            "description": "Error in retrieving all type codes and descriptions. (Internal)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error_Schema"
                }
              }
            }
          }
        }
      }
    },
    "/coct/api/zsreq/sr": {
      "post": {
        "tags": [
          "service_request_group"
        ],
        "summary": "This operation is used to create a service request in the City’s system.\n",
        "parameters": [
          {
            "name": "X-Signature",
            "in": "header",
            "description": "The X-Signature is mandatory for all POST operations.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-Session",
            "in": "header",
            "description": "This is the value of the public key issued  by the city to registered consumers.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-Service",
            "in": "header",
            "description": "This is the value of the public key issued  by the city to registered consumers.\n",
            "required": true,
            "style": "simple",
            "explode": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Request_Attributes_Schema"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "500": {
            "description": "Error in retrieving all type codes and descriptions. (Internal)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error_Schema"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Error_Schema": {
        "required": [
          "code",
          "message"
        ],
        "type": "object",
        "properties": {
          "code": {
            "type": "string"
          },
          "message": {
            "type": "string"
          }
        }
      },
      "Config_Type_Schema": {
        "required": [
          "name",
          "subtype",
          "type"
        ],
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "Cat"
          },
          "type": {
            "type": "string",
            "example": "1001"
          },
          "subtype": {
            "type": "string",
            "example": "1001"
          }
        }
      },
      "Login_Schema": {
        "required": [
          "cookie"
        ],
        "properties": {
          "cookie": {
            "type": "string",
            "example": "k;X/`[AP\\K9Bc<H^vgCv_F.J8w9/%~+V"
          }
        }
      },
      "Session_Schema": {
        "required": [
          "session_id"
        ],
        "properties": {
          "session_id": {
            "type": "string",
            "example": "k;X/`[AP\\K9Bc<H^vgCv_F.J8w9/%~+V"
          }
        }
      },
      "Request_Attributes_Schema": {
        "required": [
          "account_number",
          "address",
          "category_1",
          "category_2",
          "comm",
          "email",
          "firstName",
          "id",
          "lastName",
          "latitude",
          "longitude",
          "message",
          "street",
          "street_number",
          "subtype",
          "suburb",
          "telephone",
          "type",
          "username"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "example": 1
          },
          "category_1": {
            "type": "string",
            "example": "Support COMPLAINTS"
          },
          "category_2": {
            "type": "string",
            "example": "Street Lights - Single Light Out"
          },
          "suburb": {
            "type": "string",
            "example": "ADRIAANSE"
          },
          "email": {
            "type": "string",
            "example": "cdorsett3@loc.gov"
          },
          "message": {
            "type": "string",
            "example": "This requests was captured by the Walking the Streets program."
          },
          "address": {
            "type": "string",
            "example": "08 Maple Wood Hill"
          },
          "username": {
            "type": "string",
            "example": ""
          },
          "account_number": {
            "type": "string",
            "example": ""
          },
          "comm": {
            "type": "string",
            "example": "Maple"
          },
          "latitude": {
            "type": "string",
            "example": "-34.1080381288507"
          },
          "longitude": {
            "type": "string",
            "example": "18.47152590751648"
          },
          "type": {
            "type": "integer",
            "example": 1005
          },
          "subtype": {
            "type": "integer",
            "example": 1001
          },
          "telephone": {
            "type": "string",
            "example": ""
          },
          "firstName": {
            "type": "string",
            "example": "Gwenora"
          },
          "lastName": {
            "type": "string",
            "example": "Mellor"
          },
          "street": {
            "type": "string",
            "example": "Utah"
          },
          "street_number": {
            "type": "integer",
            "example": 76
          }
        }
      },
      "Request_Attributes_Detail_Schema": {
        "required": [
          "description",
          "message",
          "reference_number",
          "status",
          "subtype",
          "time_created",
          "type"
        ],
        "type": "object",
        "properties": {
          "reference_number": {
            "type": "string",
            "example": "2101825"
          },
          "type": {
            "type": "string",
            "example": "1001"
          },
          "subtype": {
            "type": "string",
            "example": "1002"
          },
          "description": {
            "type": "string",
            "example": "Animal carcass removal - Whale"
          },
          "status": {
            "type": "string",
            "example": "Tasks Completed"
          },
          "message": {
            "type": "string",
            "example": "Please collect the whale carcass from Muizenberg beach"
          },
          "time_created": {
            "type": "string",
            "example": "36539"
          }
        }
      }
    },
    "responses": {
      "Internal": {
        "description": "Error in retrieving all type codes and descriptions. (Internal)",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error_Schema"
            }
          }
        }
      }
    },
    "securitySchemes": {
      "cookieAuth": {
        "type": "apiKey",
        "description": "X-Service public key",
        "name": "X-Service",
        "in": "header"
      }
    }
  }
}
